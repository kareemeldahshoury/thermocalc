from typing import Dict

T_sat134a_data = {
    -40.0: [51.25, 0.0007054, 0.36081, -0.036, 207.40, 207.37, 0.000, 225.86, 225.86, 0.00000, 0.96866, 0.96866],
    -38.0: [56.86, 0.0007083, 0.32732, 2.475, 206.04, 208.51, 2.515, 224.61, 227.12, 0.01072, 0.95511, 0.96584],
    -36.0: [62.95, 0.0007112, 0.29751, 4.992, 204.67, 209.66, 5.037, 223.35, 228.39, 0.02138, 0.94176, 0.96315],
    -34.0: [69.56, 0.0007142, 0.27090, 7.517, 203.29, 210.81, 7.566, 222.09, 229.65, 0.03199, 0.92859, 0.96058],
    -32.0: [76.71, 0.0007172, 0.24711, 10.05, 201.91, 211.96, 10.10, 220.81, 230.91, 0.04253, 0.91560, 0.95813],
    -30.0: [84.43, 0.0007203, 0.22580, 12.59, 200.52, 213.11, 12.65, 219.52, 232.17, 0.05301, 0.90278, 0.95579],
    -28.0: [92.76, 0.0007234, 0.20666, 15.13, 199.12, 211.25, 15.20, 218.22, 233.43, 0.06344, 0.89012, 0.95356],
    -26.0: [101.73, 0.0007265, 0.18946, 17.69, 197.72, 209.40, 17.76, 216.92, 234.68, 0.07382, 0.87762, 0.95141],
    -24.0: [111.37, 0.0007297, 0.17395, 20.25, 196.30, 207.55, 20.33, 215.59, 235.92, 0.08414, 0.86527, 0.94941],
    -22.0: [121.72, 0.0007329, 0.15995, 22.82, 194.88, 205.70, 22.91, 214.26, 237.17, 0.09441, 0.85307, 0.94748],
    -20.0: [132.82, 0.0007362, 0.14729, 25.39, 193.45, 203.86, 25.48, 212.91, 238.41, 0.10463, 0.84101, 0.94564],
    -18.0: [144.69, 0.0007396, 0.13583, 27.98, 192.01, 201.98, 28.09, 211.55, 239.64, 0.11481, 0.82908, 0.94389],
    -16.0: [157.38, 0.0007430, 0.12542, 30.57, 190.56, 200.13, 30.69, 210.18, 240.87, 0.12493, 0.81729, 0.94222],
    -14.0: [170.93, 0.0007464, 0.11597, 33.17, 189.09, 198.33, 33.30, 208.79, 242.09, 0.13501, 0.80561, 0.94063],
    -12.0: [185.37, 0.0007499, 0.10736, 35.78, 187.62, 196.50, 35.92, 207.38, 243.30, 0.14504, 0.79406, 0.93911],
    -10.0: [200.74, 0.0007535, 0.099516, 38.40, 186.14, 194.54, 38.55, 205.96, 244.51, 0.15504, 0.78263, 0.93766],
    -8.0: [217.08, 0.0007571, 0.092352, 41.03, 184.64, 192.45, 41.19, 204.52, 245.72, 0.16498, 0.77130, 0.93629],
    -6.0: [234.44, 0.0007608, 0.085802, 43.66, 183.13, 190.30, 43.84, 203.07, 246.91, 0.17489, 0.76008, 0.93497],
    -4.0: [252.85, 0.0007646, 0.079804, 46.31, 181.61, 188.02, 46.50, 201.60, 248.10, 0.18476, 0.74896, 0.93372],
    -2.0: [272.36, 0.0007684, 0.074304, 48.96, 180.08, 185.63, 49.17, 200.11, 249.28, 0.19459, 0.73794, 0.93253],
    0.0: [293.01, 0.0007723, 0.069255, 51.63, 178.53, 183.16, 51.86, 198.60, 250.45, 0.20439, 0.72701, 0.93139],
    2.0: [314.84, 0.0007763, 0.064612, 54.30, 177.01, 180.67, 54.55, 197.07, 251.61, 0.21415, 0.71616, 0.93031],
    4.0: [337.90, 0.0007804, 0.060338, 56.99, 175.39, 178.05, 57.35, 195.51, 252.77, 0.22387, 0.70540, 0.92927],
    6.0: [362.23, 0.0007845, 0.056398, 59.68, 173.80, 175.42, 59.97, 193.94, 253.91, 0.23356, 0.69471, 0.92828],
    8.0: [387.88, 0.0007887, 0.052672, 62.39, 172.19, 172.76, 62.60, 192.36, 255.03, 0.24323, 0.68418, 0.92733],
    10.0: [414.89, 0.0007930, 0.049403, 65.10, 170.56, 170.03, 65.43, 190.73, 256.16, 0.25286, 0.67356, 0.92641],
    12.0: [443.31, 0.0007975, 0.046695, 67.83, 168.88, 167.28, 68.18, 189.00, 257.27, 0.26246, 0.66306, 0.92554],
    14.0: [473.19, 0.0008020, 0.043417, 70.57, 167.26, 164.51, 70.95, 187.23, 258.37, 0.27205, 0.65266, 0.92470],
    16.0: [504.58, 0.0008066, 0.040748, 73.32, 165.58, 161.73, 73.73, 185.73, 259.46, 0.28159, 0.64230, 0.92389],
    18.0: [537.52, 0.0008113, 0.038271, 76.08, 163.88, 158.92, 76.52, 184.01, 260.53, 0.29112, 0.63198, 0.92310],
    20.0: [572.07, 0.0008161, 0.035969, 78.86, 162.16, 241.02, 79.32, 182.27, 261.59, 0.30063, 0.62172, 0.92234],
    22.0: [608.27, 0.0008210, 0.033828, 81.64, 160.42, 242.06, 82.14, 180.49, 262.64, 0.31011, 0.61149, 0.92160],
    24.0: [646.18, 0.0008261, 0.031834, 84.44, 158.67, 243.10, 84.98, 178.69, 263.67, 0.31958, 0.60130, 0.92088],
    26.0: [685.84, 0.0008313, 0.029976, 87.26, 156.87, 244.14, 87.83, 176.85, 264.68, 0.32903, 0.59115, 0.92018],
    28.0: [727.31, 0.0008366, 0.028242, 90.09, 155.05, 245.14, 90.69, 174.95, 265.68, 0.33846, 0.58102, 0.91948],
    30.0: [770.64, 0.0008421, 0.026622, 92.93, 153.15, 246.14, 93.58, 173.08, 266.66, 0.34789, 0.57091, 0.91879],
    32.0: [815.89, 0.0008478, 0.025108, 95.79, 151.35, 247.14, 96.48, 171.14, 267.62, 0.35730, 0.56082, 0.91811],
    34.0: [863.11, 0.0008536, 0.023691, 98.66, 149.46, 248.12, 99.40, 169.21, 268.57, 0.36670, 0.55070, 0.91743],
    36.0: [912.35, 0.0008595, 0.022364, 101.55, 147.54, 249.08, 102.33, 167.16, 269.49, 0.37609, 0.54066, 0.91675],
    38.0: [963.68, 0.0008657, 0.021119, 104.45, 145.63, 250.08, 105.29, 165.03, 270.39, 0.38548, 0.53058, 0.91606],
    40.0: [1017.1, 0.0008720, 0.019952, 107.38, 143.60, 250.97, 108.26, 162.90, 271.27, 0.39486, 0.52049, 0.91536],
    42.0: [1072.8, 0.0008786, 0.018855, 110.32, 141.58, 251.89, 111.26, 160.86, 272.12, 0.40425, 0.51039, 0.91464],
    44.0: [1130.7, 0.0008854, 0.017824, 113.28, 139.52, 252.80, 114.28, 158.82, 272.95, 0.41363, 0.50027, 0.91391],
    46.0: [1191.0, 0.0008924, 0.016853, 116.26, 137.42, 253.68, 117.32, 156.43, 273.75, 0.42302, 0.49021, 0.91315],
    48.0: [1253.6, 0.0008996, 0.015939, 119.25, 135.31, 254.55, 120.39, 154.14, 274.53, 0.43242, 0.47993, 0.91236],
    52.0: [1386.2, 0.0009150, 0.014265, 125.33, 130.88, 256.21, 126.59, 149.34, 275.98, 0.45126, 0.45941, 0.91074],
    56.0: [1529.1, 0.0009317, 0.012771, 131.49, 126.28, 257.77, 132.91, 144.38, 277.30, 0.47018, 0.43863, 0.90897],
    60.0: [1682.8, 0.0009498, 0.011453, 137.71, 121.50, 259.22, 139.36, 139.10, 278.46, 0.48920, 0.41749, 0.90669],
    65.0: [1891.0, 0.0009750, 0.009950, 145.77, 115.05, 260.83, 147.10, 132.96, 280.07, 0.51223, 0.38927, 0.90359],
    70.0: [2118.2, 0.0010037, 0.008642, 154.01, 108.27, 262.15, 156.13, 124.32, 280.44, 0.53755, 0.35227, 0.89982],
    75.0: [2365.8, 0.0010372, 0.007436, 162.53, 101.23, 263.76, 164.98, 116.55, 281.53, 0.56241, 0.33222, 0.89518],
    80.0: [2635.3, 0.0010760, 0.006346, 171.40, 93.64, 265.03, 174.00, 106.35, 280.38, 0.59001, 0.30111, 0.88957],
    85.0: [2928.2, 0.0011270, 0.005486, 180.77, 82.67, 263.44, 184.07, 95.04, 279.51, 0.61473, 0.26644, 0.88117],
    90.0: [3246.9, 0.0011932, 0.004569, 190.82, 71.38, 262.20, 194.76, 82.61, 277.37, 0.64336, 0.22674, 0.87100],
    95.0: [3594.1, 0.0012933, 0.003726, 202.40, 56.47, 258.87, 207.05, 66.21, 273.26, 0.67578, 0.17711, 0.85829],
    100.0: [3975.1, 0.0015269, 0.002630, 218.72, 29.19, 247.91, 224.79, 33.58, 258.37, 0.72217, 0.08999, 0.81215]
}

def interpolate(val1, val2, x1, x2, x):
    return val1 + (val2 - val1) * (x - x1) / (x2 - x1)

class Sat134aTCalculation:
    def __init__(self, inputs: Dict[str, str]):
        self.inputs = inputs
        self.temp = float(inputs.get("temperature", 0))  # °C
        self.x_value = float(inputs.get("quality", 0))   # between 0 and 1
        self.temps = sorted(T_sat134a_data.keys())

    def calculate(self) -> Dict[str, float]:
        if not (self.temps[0] <= self.temp <= self.temps[-1]):
            raise ValueError(f"Temperature {self.temp} °C is out of range.")
        if not (0 <= self.x_value <= 1):
            raise ValueError(f"Quality {self.x_value} must be between 0 and 1.")

        if self.temp in T_sat134a_data:
            props = T_sat134a_data[self.temp]
        else:
            for i in range(len(self.temps) - 1):
                T1, T2 = self.temps[i], self.temps[i + 1]
                if T1 <= self.temp <= T2:
                    break
            props1 = T_sat134a_data[T1]
            props2 = T_sat134a_data[T2]
            props = [interpolate(props1[j], props2[j], T1, T2, self.temp) for j in range(12)]

        P_sat, v_f, v_g, u_f, u_fg, u_g, h_f, h_fg, h_g, s_f, s_fg, s_g = props

        v = v_f + self.x_value * (v_g - v_f)
        u = u_f + self.x_value * u_fg
        h = h_f + self.x_value * h_fg
        s = s_f + self.x_value * s_fg

        return {
            "saturation_temperature (°C)": self.temp,
            "pressure (kPa)": round(P_sat, 4),
            "quality": self.x_value,
            "specific_volume (m³/kg)": round(v, 6),
            "internal_energy (kJ/kg)": round(u, 2),
            "enthalpy (kJ/kg)": round(h, 2),
            "entropy (kJ/kg·K)": round(s, 5),
        }
