from typing import Dict

# Format: superheat_134a_data[pressure_MPa][temperature_C] = [v (m³/kg), u (kJ/kg), h (kJ/kg), s (kJ/kg·K)]
superheat_134a_data = {
    0.6: {
        -36.95: [0.31121, 209.12, 227.79, 0.9644],
        -10: [0.35048, 227.55, 248.58, 1.0477],
         0:  [0.36476, 234.66, 256.54, 1.0774],
        10: [0.37893, 241.92, 264.66, 1.1066],
        20: [0.39302, 249.35, 272.94, 1.1353],
        30: [0.40705, 256.95, 281.37, 1.1636],
        40: [0.42102, 264.71, 289.97, 1.1915],
        50: [0.43495, 272.64, 298.74, 1.2191],
        60: [0.44883, 280.73, 307.66, 1.2463],
        70: [0.46269, 288.99, 316.75, 1.2732],
        80: [0.47651, 297.41, 326.00, 1.2997],
        90: [0.49032, 306.00, 335.42, 1.3260],
       100: [0.50410, 314.74, 344.99, 1.3520],
    },
    1: {
        -26.37: [0.19254, 215.19, 234.44, 0.9518],
        -10: [0.20743, 226.75, 247.49, 1.0030],
         0:  [0.21630, 233.95, 255.58, 1.0332],
        10: [0.22506, 241.30, 263.81, 1.0628],
        20: [0.23373, 248.79, 272.17, 1.0918],
        30: [0.24233, 256.44, 280.68, 1.1203],
        40: [0.25088, 264.25, 289.34, 1.1484],
        50: [0.25937, 272.22, 298.16, 1.1762],
        60: [0.26783, 280.35, 307.13, 1.2035],
        70: [0.27626, 288.64, 316.26, 1.2305],
        80: [0.28465, 297.08, 325.55, 1.2572],
        90: [0.29303, 305.69, 334.99, 1.2836],
       100: [0.30138, 314.46, 344.60, 1.3096],
    },
    1.4: {
        -18.77: [0.14014, 219.54, 239.16, 0.9846],
         0:  [0.15263, 233.23, 254.60, 1.0031],
        10: [0.15908, 240.66, 262.93, 1.0331],
        20: [0.16544, 248.22, 271.38, 1.0624],
        30: [0.17172, 255.93, 279.97, 1.0912],
        40: [0.17794, 263.79, 288.70, 1.1195],
        50: [0.18412, 271.79, 297.87, 1.1474],
        60: [0.19025, 279.96, 306.59, 1.1749],
        70: [0.19635, 288.28, 315.77, 1.2020],
        80: [0.20282, 296.75, 325.09, 1.2288],
        90: [0.20847, 305.38, 334.57, 1.2553],
       100: [0.21449, 314.17, 344.20, 1.2814],
    },
    1.8: {
        -12.73: [0.11041, 222.99, 242.86, 0.9397],
        -10:    [0.11189, 225.02, 245.16, 0.9484],
         0:     [0.11722, 232.48, 253.58, 0.9798],
        10:     [0.12240, 240.00, 262.04, 1.0102],
        20:     [0.12748, 247.64, 270.59, 1.0399],
        30:     [0.13248, 255.41, 279.25, 1.0690],
        40:     [0.13741, 263.31, 288.05, 1.0975],
        50:     [0.14230, 271.36, 296.98, 1.1286],
        60:     [0.14715, 279.56, 306.05, 1.1532],
        70:     [0.15196, 287.91, 315.27, 1.1805],
        80:     [0.15673, 296.42, 324.63, 1.2074],
        90:     [0.16149, 305.07, 334.14, 1.2339],
       100:     [0.16622, 313.88, 343.80, 1.2602],
    },
    2.0: {
        -10.09: [0.09987, 224.48, 244.46, 0.9377],
        -10:    [0.09991, 224.55, 244.54, 0.9380],
         0:     [0.10481, 232.09, 253.05, 0.9698],
        10:     [0.10955, 239.67, 261.58, 1.0004],
        20:     [0.11418, 247.35, 270.18, 1.0303],
        30:     [0.11874, 255.14, 278.89, 1.0595],
        40:     [0.12322, 263.08, 287.72, 1.0882],
        50:     [0.12766, 271.15, 296.68, 1.1163],
        60:     [0.13206, 279.37, 305.78, 1.1441],
        70:     [0.13641, 287.73, 315.01, 1.1714],
        80:     [0.14074, 296.25, 324.40, 1.1983],
        90:     [0.14504, 304.92, 333.93, 1.2249],
       100:     [0.14933, 313.74, 343.60, 1.2512],
    },
    2.4: {
        -5.38:  [0.08390, 227.14, 247.28, 0.9346],
         0:     [0.08617, 231.29, 251.97, 0.9519],
        10:     [0.09026, 238.98, 260.65, 0.9831],
        20:     [0.09423, 246.74, 269.36, 1.0134],
        30:     [0.09812, 254.61, 278.16, 1.0429],
        40:     [0.10193, 262.59, 287.06, 1.0718],
        50:     [0.10570, 270.71, 296.08, 1.1001],
        60:     [0.10942, 278.97, 305.23, 1.1280],
        70:     [0.11310, 287.36, 314.51, 1.1554],
        80:     [0.11675, 295.91, 323.93, 1.1825],
        90:     [0.12038, 304.60, 333.49, 1.2092],
       100:     [0.12398, 313.44, 343.20, 1.2356],
    },
    2.8: {
        -1.25: [0.07235, 229.46, 249.72, 0.9321],
         0:    [0.07282, 230.44, 250.83, 0.9326],
        10:    [0.07646, 238.27, 259.68, 0.9680],
        20:    [0.07997, 246.13, 268.52, 0.9987],
        30:    [0.08338, 254.06, 277.41, 1.0285],
        40:    [0.08672, 262.10, 286.38, 1.0576],
        50:    [0.09000, 270.27, 295.47, 1.0862],
        60:    [0.09324, 278.56, 304.67, 1.1142],
        70:    [0.09644, 286.99, 314.00, 1.1418],
        80:    [0.09961, 295.57, 323.49, 1.1690],
        90:    [0.10275, 304.29, 333.06, 1.1956],
       100:    [0.10587, 313.14, 342.74, 1.2222],
       110:    [0.10897, 322.16, 352.61, 1.2483],
       120:    [0.11205, 331.32, 362.67, 1.2742],
       130:    [0.11512, 340.63, 372.87, 1.2997],
       140:    [0.11818, 350.09, 383.18, 1.3250],
    },
    3.2: {
        2.46: [.06360, 231.52, 251.88, .9301],
        10: [0.06609, 237.54, 258.69, 0.9544],
        20: [0.06925, 245.50, 267.66, 0.9856],
        30: [0.07231, 253.50, 276.65, 1.0157],
        40: [0.07530, 261.60, 285.70, 1.0451],
        50: [0.07823, 269.82, 294.85, 1.0739],
        60: [0.08111, 278.15, 304.11, 1.1021],
        70: [0.08395, 286.62, 313.48, 1.1298],
        80: [0.08675, 295.22, 322.98, 1.1571],
        90: [0.08953, 303.97, 332.62, 1.1840],
        100: [0.09229, 312.86, 342.40, 1.2105],
        110: [0.09503, 321.89, 352.30, 1.2367],
        120: [0.09775, 331.07, 362.35, 1.2626],
        130: [0.10045, 340.39, 372.54, 1.2882],
        140: [0.10314, 349.86, 382.87, 1.3135],
    },
    4.0: {
        8.91:   [0.051201, 235.07, 255.55, 0.9269],
        10:     [0.051506, 235.97, 256.58, 0.9305],
        20:     [0.054213, 244.18, 265.86, 0.9628],
        30:     [0.056796, 252.36, 275.07, 0.9937],
        40:     [0.059292, 260.58, 284.30, 1.0236],
        50:     [0.061724, 268.90, 293.59, 1.0528],
        60:     [0.064104, 277.32, 302.98, 1.0814],
        70:     [0.066443, 285.86, 312.44, 1.1094],
        80:     [0.068747, 294.59, 322.02, 1.1369],
        90:     [0.071023, 303.32, 331.73, 1.1640],
        100:    [0.073274, 312.26, 341.57, 1.1907],
        110:    [0.075504, 321.33, 351.53, 1.2171],
        120:    [0.077715, 330.55, 361.63, 1.2431],
        130:    [0.079913, 339.90, 371.87, 1.2688],
        140:    [0.082096, 349.41, 382.24, 1.2942],
    },
    5.0: {
    15.71: [0.041118, 238.75, 259.30, 0.9240],
    20:    [0.042215, 242.40, 263.46, 0.9383],
    30:    [0.044338, 250.84, 273.01, 0.9703],
    40:    [0.046459, 259.18, 282.61, 1.0013],
    50:    [0.048499, 267.72, 291.96, 1.0309],
    60:    [0.050468, 276.46, 301.36, 1.0592],
    70:    [0.052427, 284.89, 311.10, 1.0888],
    80:    [0.054317, 293.46, 320.97, 1.1173],
    90:    [0.056205, 302.51, 330.61, 1.1451],
    100:   [0.058063, 311.76, 340.45, 1.1725],
    110:   [0.059988, 320.63, 350.57, 1.1977],
    120:   [0.061687, 329.89, 360.93, 1.2239],
    130:   [0.063479, 339.32, 371.41, 1.2491],
    140:   [0.065256, 348.96, 382.01, 1.2736],
    150:   [0.067021, 358.81, 392.02, 1.2999],
    160:   [0.068775, 368.33, 402.72, 1.3249],
},
6.0: {
    21.55: [0.034295, 241.83, 262.40, 0.9218],
    30:    [0.035984, 249.22, 270.81, 0.9499],
    40:    [0.037865, 257.86, 280.58, 0.9826],
    50:    [0.039695, 266.48, 290.08, 1.0121],
    60:    [0.041500, 275.21, 299.61, 1.0403],
    70:    [0.043069, 283.89, 309.15, 1.0679],
    80:    [0.044616, 292.59, 318.70, 1.0950],
    90:    [0.046318, 301.31, 329.46, 1.1264],
    100:   [0.048003, 310.07, 339.44, 1.1560],
    110:   [0.049668, 318.93, 349.59, 1.1837],
    120:   [0.051317, 327.91, 359.87, 1.2103],
    130:   [0.052950, 337.00, 370.28, 1.2357],
    140:   [0.054570, 346.21, 380.82, 1.2604],
    150:   [0.055922, 355.52, 391.53, 1.2848],
    160:   [0.057006, 367.81, 402.01, 1.3088],
},
7.0: {
    26.69: [0.029361, 244.48, 265.03, 0.9199],
    30:    [0.029966, 247.48, 268.45, 0.9313],
    40:    [0.031696, 256.39, 278.31, 0.9635],
    50:    [0.033322, 265.25, 288.53, 0.9954],
    60:    [0.034847, 274.15, 298.80, 1.0258],
    70:    [0.036373, 282.87, 308.33, 1.0545],
    80:    [0.037894, 291.78, 317.91, 1.0828],
    90:    [0.039409, 300.71, 327.53, 1.1103],
    100:   [0.040921, 309.67, 337.29, 1.1371],
    110:   [0.042429, 318.73, 347.19, 1.1635],
    120:   [0.043935, 327.92, 357.22, 1.1895],
    130:   [0.045438, 337.23, 367.39, 1.2149],
    140:   [0.046939, 346.66, 377.70, 1.2399],
    150:   [0.048497, 367.29, 401.31, 1.2951],
},
8.0: {
    31.31: [0.025621, 246.79, 267.29, 0.9183],
    40:    [0.027035, 254.82, 276.45, 0.9480],
    50:    [0.028547, 263.86, 286.69, 0.9802],
    60:    [0.029973, 272.83, 296.81, 1.0110],
    70:    [0.031340, 281.81, 306.88, 1.0408],
    80:    [0.032659, 290.84, 316.97, 1.0698],
    90:    [0.033941, 299.95, 327.10, 1.0981],
    100:   [0.035193, 309.13, 337.30, 1.1258],
    110:   [0.036420, 318.45, 347.59, 1.1530],
    120:   [0.037628, 327.87, 357.97, 1.1797],
    130:   [0.038815, 337.40, 368.45, 1.2061],
    140:   [0.039985, 347.04, 379.03, 1.2319],
    150:   [0.041143, 356.85, 389.76, 1.2577],
    160:   [0.042290, 366.76, 400.59, 1.2830],
    170:   [0.043427, 376.81, 411.55, 1.3080],
    180:   [0.044554, 386.99, 422.64, 1.3327],
},
9.0: {
    35.51: [0.022683, 248.85, 269.26, 0.9169],
    40:    [0.023375, 253.13, 274.17, 0.9327],
    50:    [0.024809, 262.44, 284.77, 0.9660],
    60:    [0.026146, 271.70, 295.33, 0.9976],
    70:    [0.027413, 280.72, 305.39, 1.0280],
    80:    [0.028628, 289.86, 315.63, 1.0574],
    90:    [0.029806, 299.06, 325.89, 1.0860],
    100:   [0.030960, 308.31, 336.19, 1.1138],
    110:   [0.032086, 317.70, 346.56, 1.1410],
    120:   [0.033196, 327.20, 357.02, 1.1675],
    130:   [0.034294, 336.82, 367.56, 1.1936],
    140:   [0.035382, 346.56, 378.23, 1.2193],
    150:   [0.036543, 356.42, 389.03, 1.2467],
    160:   [0.037694, 366.39, 399.96, 1.2727],
    170:   [0.038408, 376.31, 410.88, 1.2972],
    180:   [0.039423, 386.52, 422.00, 1.3221],
},
10.0: {
    39.37: [0.020313, 250.68, 270.99, 0.9156],
    40:    [0.020406, 251.30, 271.11, 0.9179],
    50:    [0.021796, 260.94, 282.04, 0.9525],
    60:    [0.023158, 270.63, 292.13, 0.9850],
    70:    [0.024261, 279.59, 303.85, 1.0158],
    80:    [0.025398, 288.86, 314.35, 1.0458],
    90:    [0.026492, 298.15, 324.64, 1.0749],
    100:   [0.027552, 307.48, 334.97, 1.1036],
    110:   [0.028584, 316.94, 345.55, 1.1308],
    120:   [0.029591, 326.51, 356.35, 1.1573],
    130:   [0.030579, 336.20, 367.35, 1.1834],
    140:   [0.031553, 346.02, 378.49, 1.2090],
    150:   [0.032515, 355.95, 389.74, 1.2343],
    160:   [0.033470, 366.00, 401.13, 1.2593],
    170:   [0.034392, 375.81, 410.20, 1.2875],
    180:   [0.035317, 386.04, 421.36, 1.3124],
},
12.0: {
    46.29: [0.016715, 253.81, 273.87, 0.9130],
    50:    [0.017201, 257.63, 278.27, 0.9267],
    60:    [0.018404, 267.56, 289.64, 0.9614],
    70:    [0.019502, 277.21, 300.61, 0.9938],
    80:    [0.020529, 286.75, 311.39, 1.0248],
    90:    [0.021506, 296.26, 322.07, 1.0546],
    100:   [0.022442, 305.80, 332.73, 1.0836],
    110:   [0.023348, 315.38, 343.49, 1.1118],
    120:   [0.024228, 325.03, 354.11, 1.1394],
    130:   [0.025087, 334.76, 364.75, 1.1664],
    140:   [0.025927, 344.61, 375.72, 1.1930],
    150:   [0.026753, 354.56, 386.66, 1.2192],
    160:   [0.027566, 364.61, 397.69, 1.2449],
    170:   [0.028367, 374.78, 408.82, 1.2703],
    180:   [0.029158, 385.08, 420.07, 1.2954],
},
14.0: {
    52.40: [0.014107, 256.37, 276.12, 0.9105],
    60:    [0.015005, 264.46, 285.47, 0.9389],
    70:    [0.016060, 274.62, 297.10, 0.9733],
    80:    [0.017023, 284.51, 308.34, 1.0056],
    90:    [0.017923, 294.28, 319.37, 1.0364],
    100:   [0.018778, 304.01, 330.30, 1.0661],
    110:   [0.019597, 313.77, 341.17, 1.0949],
    120:   [0.020388, 323.55, 352.09, 1.1230],
    130:   [0.021153, 333.41, 363.02, 1.1504],
    140:   [0.021896, 343.34, 374.01, 1.1773],
    150:   [0.022621, 353.36, 385.07, 1.2038],
    160:   [0.023355, 363.61, 396.20, 1.2298],
    170:   [0.024067, 373.87, 407.43, 1.2554],
    180:   [0.024757, 384.10, 418.76, 1.2807],
},
16.0: {
    57.88: [0.012123, 258.47, 277.86, 0.9078],
    60:    [0.012372, 260.89, 280.69, 0.9163],
    70:    [0.013430, 271.76, 293.25, 0.9535],
    80:    [0.014362, 282.09, 305.07, 0.9875],
    90:    [0.015215, 292.17, 316.52, 1.0194],
    100:   [0.016014, 302.14, 327.76, 1.0500],
    110:   [0.016774, 312.06, 338.85, 1.0793],
    120:   [0.017500, 322.02, 350.01, 1.1081],
    130:   [0.018194, 332.06, 361.22, 1.1360],
    140:   [0.018862, 342.18, 372.50, 1.1634],
    150:   [0.019507, 352.37, 383.84, 1.1902],
    160:   [0.020134, 362.68, 395.26, 1.2165],
    170:   [0.020738, 372.69, 406.02, 1.2421],
    180:   [0.021456, 383.11, 417.44, 1.2676],
}
    
}

def interpolate(val1, val2, x1, x2, x):
    return val1 + (val2 - val1) * (x - x1) / (x2 - x1)

class Superheat134aCalculation:
    def __init__(self, inputs: Dict[str, str]):
        self.inputs = inputs
        self.pressure = float(inputs.get("pressure", 0))  # MPa
        self.temperature = float(inputs.get("temperature", 0))  # °C
        self.available_pressures = sorted(superheat_134a_data.keys())

    def calculate(self) -> Dict[str, float]:
        if self.pressure not in superheat_134a_data:
            raise ValueError(f"Pressure {self.pressure} MPa not available in data.")
        
        temp_dict = superheat_134a_data[self.pressure]
        available_temps = sorted([t for t in temp_dict if t != "sat"])

        if self.temperature == "sat":
            v, u, h, s = temp_dict["sat"]
        elif self.temperature in temp_dict:
            v, u, h, s = temp_dict[self.temperature]
        else:
            for i in range(len(available_temps) - 1):
                T1, T2 = available_temps[i], available_temps[i + 1]
                if T1 <= self.temperature <= T2:
                    break
            vals1 = temp_dict[T1]
            vals2 = temp_dict[T2]
            v = interpolate(vals1[0], vals2[0], T1, T2, self.temperature)
            u = interpolate(vals1[1], vals2[1], T1, T2, self.temperature)
            h = interpolate(vals1[2], vals2[2], T1, T2, self.temperature)
            s = interpolate(vals1[3], vals2[3], T1, T2, self.temperature)

        return {
            "pressure (bar)": self.pressure,
            "temperature (°C)": round(self.temperature, 2),
            "specific_volume (m³/kg)": round(v, 6),
            "internal_energy (kJ/kg)": round(u, 2),
            "enthalpy (kJ/kg)": round(h, 2),
            "entropy (kJ/kg·K)": round(s, 5),
        }
